- id: "1539104120193"
  alias: Windows open
  trigger:
    - entity_id:
        - group.downstairs_windows
      from: "off"
      platform: state
      to: "on"
  condition: []
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Wykryłem otwarte okno, wyłączam oczyszczacz powietrza.
        language: pl
    - data:
        command: PowerToggle
        device: 42382138
        entity_id: remote.jaskrowo_media
      service: remote.send_command
- id: "1539104502084"
  alias: Windows closed
  trigger:
    - entity_id:
        - group.downstairs_windows
      from: "on"
      platform: state
      to: "off"
  condition: []
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Wszystkie okna zamknięte, włączam oczyszczacz powietrza.
        language: pl
    - data:
        command: PowerToggle
        device: 42382138
        entity_id: remote.jaskrowo_media
      service: remote.send_command
- id: "1541261179517"
  alias: Living room motion - 01 normal
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      platform: state
      to: "on"
  condition:
    - below: "75"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e43ac7_illuminance
    - after: 07:50:00
      before: "19:59:59"
      condition: time
  action:
    - data:
        entity_id: scene.living_room_day
      service: scene.turn_on
    - data:
        entity_id: switch.circadian_lighting_living_room_auto_ceiling
      service: switch.turn_on
- id: "1541276365179"
  alias: Living room motion - 02 evening
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      platform: state
      to: "on"
  condition:
    - below: "0"
      condition: numeric_state
      entity_id: sun.sun
      value_template: "{{ state.attributes.elevation }}"
    - after: 07:50:00
      before: "19:59:59"
      condition: time
    - below: "75"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e43ac7_illuminance
  action:
    - data:
        entity_id: scene.living_room_evening
      service: scene.turn_on
    - data:
        entity_id: switch.circadian_lighting_living_room_auto_ceiling
      service: switch.turn_on
- id: "1541276548411"
  alias: Living room motion - 03 TV mode
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      platform: state
      to: "on"
  condition:
    - after: "20:00:00"
      before: 03:49:59
      condition: time
    - below: "75"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e43ac7_illuminance
  action:
    - data:
        entity_id: scene.living_room_tv_mode
      service: scene.turn_on
    - data:
        entity_id: switch.circadian_lighting_living_room_auto_ceiling
      service: switch.turn_on
- id: "1541319904416"
  alias: Hall - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0001e531e0_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: light.downstairs_hall_lamp
      state: "off"
    - below: "35"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e531e0_illuminance
  action:
    - data:
        entity_id: switch.circadian_lighting_hall_lights_auto
      service: switch.turn_on
    - data:
        entity_id: light.downstairs_hall_lamp
        transition: 1
      service: light.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e531e0_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        | int >= 180 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: light.downstairs_hall_lamp
      state: "on"
    - data:
        entity_id: light.downstairs_hall_lamp
      service: light.turn_off
- id: "1541327330757"
  alias: Hall - empty room
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        | int >= 600 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: light.downstairs_hall_lamp
      state: "on"
  action:
    - data:
        entity_id: light.downstairs_hall_lamp
        transition: 1
      service: light.turn_off
- id: "1541327802282"
  alias: Living room - stair LEDs
  trigger:
    - entity_id: binary_sensor.0x00158d0001e4707c_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: light.stairs_leds
      state: "off"
    - below: "50"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e4707c_illuminance
  action:
    - data:
        entity_id: light.stairs_leds
      service: light.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e4707c_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e4707c_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e4707c_occupancy'].attributes.no_occupancy_since
        | int >= 180 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: light.stairs_leds
      state: "on"
    - data:
        entity_id: light.stairs_leds
      service: light.turn_off
- id: "1541328487535"
  alias: Living room - empty room
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0001e43ac7_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e43ac7_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e43ac7_occupancy'].attributes.no_occupancy_since
        | int >= 900 %}True{% else %}False{% endif %}"
    - entity_id: sensor.0x00158d000101c2a1_action
      platform: state
      to: flip180
  condition:
    - condition: state
      entity_id: group.living_room_lights
      state: "on"
  action:
    - data:
        entity_id:
          - group.living_room_lights
      service: homeassistant.turn_off
- id: "1541522658112"
  alias: Attic - entry area motion
  trigger:
    - entity_id: binary_sensor.0x00158d0001e547ae_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - below: "30"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e547ae_illuminance
  action:
    - data:
        entity_id:
          - light.0x00158d0003fa55ab_light
          - light.attic_right_lamp_light
        transition: 1
      service: light.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e547ae_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e547ae_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e547ae_occupancy'].attributes.no_occupancy_since
        | int >= 180 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: light.0x00158d0003fa55ab_light
      state: "on"
    - data:
        entity_id:
          - light.0x00158d0003fa55ab_light
          - light.attic_right_lamp_light
        transition: 1
      service: light.turn_off
- id: "1541525021925"
  alias: Attic - wardrobe area motion
  trigger:
    - entity_id: binary_sensor.0x00158d0001e55ff7_occupancy
      from: "off"
      platform: state
      to: "on"
  action:
    - data:
        entity_id: light.0x00158d000410f2db_light
        transition: 1
      service: light.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e55ff7_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e55ff7_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e55ff7_occupancy'].attributes.no_occupancy_since
        | int >= 180 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: light.0x00158d000410f2db_light
      state: "on"
    - data:
        entity_id: light.0x00158d000410f2db_light
        transition: 1
      service: light.turn_off
- id: "1541876800870"
  alias: Attic - empty room
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0001e547ae_occupancy'].state
        == 'off'  and states.binary_sensor['0x00158d0001e547ae_occupancy'].attributes.no_occupancy_since
        is defined and states.binary_sensor['0x00158d0001e547ae_occupancy'].attributes.no_occupancy_since
        | int >= 600 and states.binary_sensor['0x00158d0001e55ff7_occupancy'].state
        == 'off'  and states.binary_sensor['0x00158d0001e55ff7_occupancy'].attributes.no_occupancy_since
        is defined and states.binary_sensor['0x00158d0001e55ff7_occupancy'].attributes.no_occupancy_since
        | int >= 600 %}True{% else %}False{% endif %}"
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: light.0x00158d0003fa55ab_light
        state: "on"
      - condition: state
        entity_id: light.attic_right_lamp_light
        state: "on"
      - condition: state
        entity_id: light.0x00158d000410f2db_light
        state: "on"
  action:
    - data:
        entity_id:
          - light.0x00158d0003fa55ab_light
          - light.attic_right_lamp_light
          - light.0x00158d000410f2db_light
        transition: 1
      service: light.turn_off
- id: "1542048714041"
  alias: Guest room - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0001e532dc_occupancy
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: group.guest_room_lights
      state: "off"
    - below: "30"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e532dc_illuminance
  action:
    - data:
        entity_id:
          - group.guest_room_lights
        transition: 1
      service: homeassistant.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e532dc_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e532dc_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e532dc_occupancy'].attributes.no_occupancy_since
        | int >= 180 %}True{% else %}False{% endif %}"
    - data:
        entity_id:
          - group.guest_room_lights
        transition: 1
      service: homeassistant.turn_off
- id: "1542050718235"
  alias: Guest room - toggle light
  trigger:
    - entity_id: sensor.0x00158d0001b182db_click
      platform: state
      to: single
    - entity_id: sensor.0x00158d0001be5b10_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id:
          - group.guest_room_lights
        transition: 1
      service: homeassistant.toggle
- id: "1543665916713"
  alias: Living room - bright enough
  trigger:
    - above: "175"
      entity_id: sensor.0x00158d0001e43ac7_illuminance
      for: 0:03:00
      platform: numeric_state
  condition:
    - condition: state
      entity_id: group.living_room_lights
      state: "on"
  action:
    - data:
        language: pl
        message: Wygląda, że jest wystarczająco jasno - wyłączam światła.
      entity_id: media_player.lenovosmartdisplay88416
      service: tts.google_translate_say
    - data:
        entity_id:
          - group.living_room_lights
      service: homeassistant.turn_off
- id: "1543859792965"
  alias: Tosia room - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0002b85113_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - below: "60"
      condition: numeric_state
      entity_id: sensor.0x00158d0002b85113_illuminance
    - condition: time
      after: 09:00:00
      before: "20:00:00"
    - condition: state
      entity_id: group.tosia_bedroom_lights
      state: "off"
  action:
    - data:
        entity_id:
          - light.0xec1bbdfffeb7fbbc_light
          - light.0x00158d0002b88c1c_light
      service: light.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0002b85113_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0002b85113_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002b85113_occupancy'].attributes.no_occupancy_since
        | int >= 600 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: group.tosia_bedroom_lights
      state: "on"
    - data:
        entity_id: group.tosia_bedroom_lights
      service: homeassistant.turn_off
- id: "1544955116908"
  alias: Tosia toggle lamp
  trigger:
    - entity_id: sensor.0x00158d0001b1827e_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: light.tosia_lamp
        transition: 1
      service: light.toggle
- id: "1544955175467"
  alias: Tosia toggle Christmas tree
  trigger:
    - entity_id: sensor.0x00158d0001b1827e_click
      platform: state
      to: double
  condition: []
  action:
    - data:
        entity_id:
          - switch.0x00158d0003951ef9_switch
      service: switch.toggle
- id: "1544967617743"
  alias: Leaving home
  trigger:
    - entity_id: sensor.0x00158d00019d5813_click
      platform: state
      to: long
  condition: []
  action:
    - data:
        entity_id: remote.jaskrowo_media
      service: remote.turn_off
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Do zobaczenia później - wyłączam światła.
        language: pl
    - delay: 00:00:02
    - service: light.turn_off
      data:
        entity_id: all
    - data:
        entity_id: fan.xiaomi_smart_fan
      service: fan.turn_off
    - service: switch.turn_off
      data:
        entity_id:
          - switch.shelly1_5556b7_relay_0
          - switch.shelly1_554b82_relay_0
          - switch.shelly1_55df6e_relay_0
          - switch.shelly2_5a4ada_relay_0
          - switch.shelly2_5a4ada_relay_1
          - switch.shelly1_2c03c5_relay_0
          - switch.shelly1_5545a9_relay_0
          - switch.0x00158d0003951e91_switch
          - switch.shelly1_55e273_relay_0
- id: "1544970728739"
  alias: Coming home
  trigger:
    - entity_id: sensor.0x00158d00019d5813_click
      platform: state
      to: single
  condition: []
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Witaj w domu! Włączam światła.
        language: pl
    - data:
        entity_id: scene.living_room_normal
      service: scene.turn_on
    - data:
        entity_id:
          - light.downstairs_hall_lamp
          - light.xiaomi_philips_ceiling_light
          - light.stove_leds
        transition: 1
      service: light.turn_on
    - service: switch.turn_on
      data:
        entity_id:
          - switch.shelly1_55df6e_relay_0
- id: "1545557982983"
  alias: Turn on Circadian Lighting switches on startup
  trigger:
    - event: start
      platform: homeassistant
  condition: []
  action:
    - data:
        entity_id:
          - switch.circadian_lighting_hall_lights_auto
          - switch.circadian_lighting_living_room_auto_ceiling
          - switch.circadian_lighting_living_room_auto_leds
          - switch.circadian_lighting_guest_room_lights_auto
          - switch.circadian_lighting_attic_lights_auto
          - switch.circadian_lighting_master_bedroom_lights_auto
          - switch.circadian_lighting_kitchen_lights_auto
          - switch.circadian_lighting_tosia_room_lights_auto
          - switch.circadian_lighting_wardrobe_lights_auto
          - switch.circadian_lighting_downstairs_bathroom_lights_auto
      service: switch.turn_on
- id: "1545565835153"
  alias: Master bedroom - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43bc7_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: light.master_bedroom_bed_lamp
      state: "off"
    - below: "20"
      condition: numeric_state
      entity_id: sensor.0x00158d0001e43bc7_illuminance
    - after: "10:00:00"
      before: "21:00:00"
      condition: time
  action:
    - data:
        entity_id:
          - light.master_bedroom_bed_lamp
          - light.gateway_light_34ce00fb56e8
          - light.bed_leds
        transition: 1
      service: light.turn_on
    - data:
        entity_id:
          - switch.shelly1_55e273_relay_0
      service: switch.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e43bc7_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e43bc7_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e43bc7_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: group.master_bedroom_lights
      state: "on"
    - data:
        entity_id:
          - group.master_bedroom_lights
      service: homeassistant.turn_off
- id: "1545565868381"
  alias: Master bedroom - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0001e43bc7_occupancy'].state
        == 'off'  and states.binary_sensor['0x00158d0001e43bc7_occupancy'].attributes.no_occupancy_since
        is defined and states.binary_sensor['0x00158d0001e43bc7_occupancy'].attributes.no_occupancy_since
        | int >= 1800 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: group.master_bedroom_lights
      state: "on"
  action:
    - data:
        entity_id:
          - group.master_bedroom_lights
      service: homeassistant.turn_off
- id: "1545992685443"
  alias: Tosia room - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0002b85113_occupancy'].state
        == 'off'  and states.binary_sensor['0x00158d0002b85113_occupancy'].attributes.no_occupancy_since
        is defined and states.binary_sensor['0x00158d0002b85113_occupancy'].attributes.no_occupancy_since
        | int >= 1800 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: group.tosia_bedroom_lights
      state: "on"
  action:
    - data:
        entity_id:
          - group.tosia_bedroom_lights
      service: homeassistant.turn_off
- id: "1545994936009"
  alias: Living room left wall switch - right click
  trigger:
    - entity_id: sensor.0x00158d0001e06c11_click
      platform: state
      to: right
  condition: []
  action:
    - data:
        entity_id:
          - light.stairs_leds
          - light.wall_leds
        transition: 1
      service: light.toggle
- id: "1545994964595"
  alias: Living room left wall switch - left click
  trigger:
    - entity_id: sensor.0x00158d0001e06c11_click
      platform: state
      to: left
  condition: []
  action:
    - data:
        entity_id: light.downstairs_hall_lamp
        transition: 1
      service: light.toggle
- id: "1545994990745"
  alias: Living room left wall switch - both click
  trigger:
    - entity_id: sensor.0x00158d0001e06c11_click
      platform: state
      to: both
  condition: []
  action:
    - data:
        entity_id:
          - group.living_room_lights
          - group.kitchen_lights
        transition: 1
      service: homeassistant.toggle
- id: "1545995929931"
  alias: Living room right wall switch - left click
  trigger:
    - entity_id: sensor.0x00158d0001f42198_click
      platform: state
      to: left
    - entity_id: sensor.0x00158d000101c2a1_action
      platform: state
      to: flip90
  condition: []
  action:
    - data:
        entity_id: light.xiaomi_philips_ceiling_light
        transition: 1
      service: light.toggle
- id: "1545995954625"
  alias: Living room right wall switch - right click
  trigger:
    - entity_id: sensor.0x00158d0001f42198_click
      platform: state
      to: right
    - entity_id: sensor.0x00158d000101c2a1_action
      platform: state
      to: slide
  action:
    - data:
        entity_id: switch.shelly1_5556b7_relay_0
      service: switch.toggle
- id: "1545995978732"
  alias: Living room right wall switch - both click
  trigger:
    - entity_id: sensor.0x00158d0001f42198_click
      platform: state
      to: both
    - entity_id: sensor.0x00158d000101c2a1_action
      platform: state
      to: shake
  condition: []
  action:
    - data:
        entity_id: switch.circadian_lighting_living_room_auto_ceiling
      service: switch.turn_off
    - data:
        entity_id: light.xiaomi_philips_ceiling_light
        transition: 1
        brightness: 255
      service: light.turn_on
    - data:
        entity_id: light.xiaomi_philips_ceiling_light
        scene: 1
      service: light.xiaomi_miio_set_scene
- id: "1545996231997"
  alias: Hall wall switch - left click
  trigger:
    - entity_id: sensor.0x00158d0001f3f75e_click
      platform: state
      to: left
  condition: []
  action:
    - data:
        entity_id: switch.circadian_lighting_hall_lights_auto
      service: switch.turn_off
    - data:
        entity_id: light.downstairs_hall_lamp
        transition: 1
      service: light.toggle
- id: "1545996260772"
  alias: Hall wall switch - right click
  trigger:
    - entity_id: sensor.0x00158d0001f3f75e_click
      platform: state
      to: right
  condition: []
  action:
    - data:
        entity_id: light.xiaomi_philips_ceiling_light
        transition: 1
      service: light.toggle
- id: "1546010274549"
  alias: Master bedroom - toggle lights
  trigger:
    - entity_id: sensor.0x00158d0002b455e6_click
      platform: state
      to: both
    - entity_id: sensor.0x00158d00016dbe9e_click
      platform: state
      to: single
    - entity_id: sensor.0x00158d00019ca9dc_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id:
          - light.master_bedroom_bed_lamp
          - light.bed_leds
          - light.gateway_light_34ce00fb56e8
        transition: 1
      service: light.toggle
    - data:
        entity_id:
          - switch.shelly1_55e273_relay_0
      service: switch.toggle
- id: "1546010333874"
  alias: Master bedroom - toggle LEDs
  trigger:
    - entity_id: sensor.0x00158d00016dbe9e_click
      platform: state
      to: double
    - entity_id: sensor.0x00158d00019ca9dc_click
      platform: state
      to: double
  condition: []
  action:
    - data:
        entity_id: light.bed_leds
        transition: 1
      service: light.toggle
- id: "1546010434351"
  alias: Master bedroom - toggle gateway
  trigger:
    - entity_id: sensor.0x00158d00016dbe9e_click
      platform: state
      to: long
    - entity_id: sensor.0x00158d00019ca9dc_click
      platform: state
      to: long
  condition: []
  action:
    - data:
        entity_id: light.gateway_light_34ce00fb56e8
        transition: 1
      service: light.toggle
- id: "1546013441545"
  alias: Kitchen - motion daytime
  trigger:
    - entity_id: binary_sensor.0x00158d0002ec7efa_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: switch.shelly1_55df6e_relay_0
      state: "off"
    - below: "60"
      condition: numeric_state
      entity_id: sensor.0x00158d0002ec7efa_illuminance
    - after: 06:30:00
      before: "22:00:00"
      condition: time
  action:
    - data:
        entity_id:
          - switch.shelly1_55df6e_relay_0
      service: switch.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0002ec7efa_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0002ec7efa_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002ec7efa_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: group.kitchen_lights
      state: "on"
    - data:
        entity_id:
          - switch.shelly1_55df6e_relay_0
      service: switch.turn_off
- id: "1546013479738"
  alias: Kitchen - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0002ec7efa_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002ec7efa_occupancy'].attributes.no_occupancy_since
        | int >= 600 %}True{% else %}False{% endif %}"
  condition:
    condition: state
    entity_id: group.kitchen_lights
    state: "on"
  action:
    - data:
        entity_id:
          - group.kitchen_lights
      service: homeassistant.turn_off
- id: "1546014691265"
  alias: Attic - toggle left entry light
  trigger:
    - entity_id: sensor.0x00158d0001f9c3fe_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: light.0x00158d0003fa55ab_light
        transition: 1
      service: light.toggle
- id: "1546014728200"
  alias: Attic - toggle right entry light
  trigger:
    - entity_id: sensor.0x00158d0001f9c3fe_click
      platform: state
      to: double
  condition: []
  action:
    - data:
        entity_id: light.attic_right_lamp_light
        transition: 1
      service: light.toggle
- id: "1546014760465"
  alias: Attic - toggle wardrobe area light
  trigger:
    - entity_id: sensor.0x00158d0001f9c3fe_click
      platform: state
      to: long
  condition: []
  action:
    - data:
        entity_id: light.0x00158d000410f2db_light
        transition: 1
      service: light.toggle
- id: "1546020188168"
  alias: Tosia feeder - gryzkaj, gryzkaj
  trigger:
    - entity_id: sensor.0x00158d0001d8eeb1_click
      platform: state
      to: single
  condition: []
  action:
    - service: tts.google_translate_say
      entity_id: media_player.living_room_speaker
      data_template:
        message:
          "{{ [ 'No dalej Tosia! Gryzkaj. Gryzkaj.', 'Tosia gryziemy. Duży
          gryz a nie taki malutki.', 'Tosia jemy jemy, następny gryzek', 'Dalej
          Tosia, już Ci niedużo zostało', 'Coś dziś królisie słabo jedzą', 'Tosia.
          Pusta buzia. To kolejny gryzek!', 'No dalej Tosia, bo będziemy tu siedzieć
          godzinę' ] | random }}

          "
        language: pl
- alias: Tata talks - tani podryw
  trigger:
    - entity_id: sensor.0x00158d0001d8eeb1_click
      platform: state
      to: double
  condition: []
  action:
    - service: tts.google_translate_say
      entity_id: media_player.living_room_speaker
      data_template:
        message:
          "{{ [ 'Gdybyś była warzywem, byłabyś cud-kinią', 'Czy tu jest tak
          gorąco, czy to po prostu Ty?', 'Masz chłopaka - to już najwyższy czas, byś
          poczuła, jak to jest mieć prawdziwego mężczyznę.', 'Gdybyś była kanapką
          w McDonald’s, nazywałabyś się McBeauty.', 'Myślę, że masz coś w oku. Och,
          spoko, to tylko błysk...', 'Jesteś tak piękna, że aż sam nie wiem, co powiedzieć.',
          'Przepraszam, czy ja jestem w cukierni, bo widzę niezłe ciasteczko', 'Masz
          może mapę? Bo zgubiłem się w twoich oczach', 'Oj, Mała. Gdybyś była rzodkiewką,
          już dawno bym Cię wyrwał.' ] | random }}

          "
        language: pl
  id: a1bf7283148a4ddfb56dad1d30ef108a
- id: "1546020275655"
  alias: Tosia feeder - nie złość Mamy!
  trigger:
    - entity_id: sensor.0x00158d0001d8eeb1_click
      platform: state
      to: long
  condition: []
  action:
    - service: tts.google_translate_say
      entity_id: media_player.living_room_speaker
      data_template:
        message:
          "{{ [\n  'Dalej Tosia, nie złość Mamy.',\n  'Tosia bo sobie pójdę i\
          \ będziesz tu siedzieć sama',\n  'Dziś to chyba nie będzie żadnej nagrody',\n\
          \  'Tosia, bo nie będzie już czasu na żadną bajkę'\n  ] | random }}\n"
        language: pl
- id: "1546091775458"
  alias: Kitchen - bright enough
  trigger:
    - above: "120"
      entity_id: sensor.0x00158d0002ec7efa_illuminance
      platform: numeric_state
      for:
        minutes: 3
  condition:
    condition: or
    conditions:
      - condition: state
        entity_id: group.kitchen_lights
        state: "on"
      - condition: state
        entity_id: group.dining_area_lights
        state: "on"
  action:
    - service: tts.google_translate_say
      entity_id: media_player.living_room_speaker
      data:
        message: Wygląda, że w kuchni jest wystarczająco jasno - wyłączam światła.
        language: pl
    - data:
        entity_id: light.stove_leds
        transition: 1
      service: light.turn_off
    - data:
        entity_id:
          - group.kitchen_lights
          - group.dining_area_lights
      service: homeassistant.turn_off
- id: "1548095677962"
  alias: Downstairs bathroom - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0002b422b4_occupancy
      from: "off"
      platform: state
      to: "on"
    - entity_id: binary_sensor.0x00158d0002ebdbdf_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: group.downstairs_bathroom_lights
      state: "off"
  action:
    - data:
        entity_id: group.downstairs_bathroom_lights
        transition: 1
      service: homeassistant.turn_on
- id: "1548095715939"
  alias: Downstairs bathroom - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0002b422b4_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002b422b4_occupancy'].attributes.no_occupancy_since
        | int >= 600 and states.binary_sensor['0x00158d0002ebdbdf_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002ebdbdf_occupancy'].attributes.no_occupancy_since
        | int >= 1200 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: group.downstairs_bathroom_lights
      state: "on"
  action:
    - data:
        entity_id: group.downstairs_bathroom_lights
        transition: 1
      service: homeassistant.turn_off
- id: "1549129661008"
  alias: Tosia wall switch - left button
  trigger:
    - entity_id: sensor.0x00158d0002b453ca_click
      platform: state
      to: left
  condition: []
  action:
    - data:
        entity_id: light.0xec1bbdfffeb7fbbc_light
        transition: 1
      service: light.toggle
- id: "1549129689282"
  alias: Tosia wall switch - right click
  trigger:
    - entity_id: sensor.0x00158d0002b453ca_click
      platform: state
      to: right
  condition: []
  action:
    - data:
        entity_id:
          - light.0x00158d0002b88c1c_light
        transition: 1
      service: light.toggle
- id: "1549129715747"
  alias: Tosia wall switch - both buttons
  trigger:
    - entity_id: sensor.0x00158d0002b453ca_click
      platform: state
      to: both
  condition: []
  action:
    - data:
        entity_id:
          - light.0xec1bbdfffeb7fbbc_light
          - light.0x00158d0002b88c1c_light
      service: light.toggle
- id: "1549179592040"
  alias: Wardrobe - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0002b70d79_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: light.wardrobe_lamp
      state: "off"
    - below: "35"
      condition: numeric_state
      entity_id: sensor.0x00158d0002b70d79_illuminance
  action:
    - data:
        entity_id: switch.circadian_lighting_wardrobe_lights_auto
      service: switch.turn_on
    - data:
        entity_id: light.wardrobe_lamp
        transition: 1
      service: light.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0002b70d79_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0002b70d79_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002b70d79_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: light.wardrobe_lamp
      state: "on"
    - data:
        entity_id: light.wardrobe_lamp
      service: light.turn_off
- id: "1549179643827"
  alias: Wardrobe - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0002b70d79_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002b70d79_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: light.wardrobe_lamp
      state: "on"
  action:
    - data:
        entity_id: light.wardrobe_lamp
        transition: 1
      service: light.turn_off
- id: "1549179693148"
  alias: Wardrobe - toggle light
  trigger:
    - entity_id: sensor.0x00158d0002828af1_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: light.wardrobe_lamp
        transition: 1
      service: light.toggle
- id: "1549196193367"
  alias: Master bedroom - toggle stairs lamps
  trigger:
    - entity_id: sensor.0x00158d0002b455e6_click
      platform: state
      to: left
  condition: []
  action:
    - data:
        entity_id: switch.shelly1_55e273_relay_0
      service: switch.toggle
- id: "1549196224140"
  alias: Master bedroom - toggle wall lamp
  trigger:
    - entity_id: sensor.0x00158d0002b455e6_click
      platform: state
      to: right
  condition: []
  action:
    - data:
        entity_id: switch.shelly1_2c03c5_relay_0
      service: switch.toggle
- id: "1549196304469"
  alias: Upstairs bathroom - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0002b72030_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: switch.shelly1_5545a9_relay_0
      state: "off"
    - after: 06:30:00
      before: "22:00:00"
      condition: time
  action:
    - data:
        entity_id: switch.shelly1_5545a9_relay_0
      service: switch.turn_on
- id: "1549196345036"
  alias: Upstairs bathroom - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0002b72030_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002b72030_occupancy'].attributes.no_occupancy_since
        | int >= 900 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: switch.shelly1_5545a9_relay_0
      state: "on"
  action:
    - data:
        entity_id: switch.shelly1_5545a9_relay_0
      service: switch.turn_off
- id: "1549196390092"
  alias: Upstairs bathroom - toggle light
  trigger:
    - entity_id: sensor.0x00158d000282896e_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: switch.shelly1_5545a9_relay_0
      service: switch.toggle
- id: "1549390161319"
  alias: Smog - air is clean
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      from: "off"
      platform: state
      to: "on"
    - entity_id: binary_sensor.0x00158d0002ec7efa_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - entity_id: sensor.airly_caqi
      condition: numeric_state
      below: 25
    - condition: state
      entity_id: group.downstairs_windows
      state: "off"
      for:
        hours: 24
    - condition: time
      after: 09:00:00
      before: "20:00:00"
    - condition: template
      value_template:
        "{{ as_timestamp(now()) - as_timestamp(states.automation.smog_air_is_clean.attributes.last_triggered)
        | int > 600 }}"
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Powietrze na zewnątrz jest czyste, przewietrzmy mieszkanie.
        language: pl
- id: "1549391089936"
  alias: Smog - close the windows
  trigger:
    - platform: time_pattern
      minutes: /2
    - entity_id:
        - group.downstairs_windows
      from: "off"
      platform: state
      to: "on"
  condition:
    - above: "75"
      condition: numeric_state
      entity_id: sensor.airly_caqi
    - condition: or
      conditions:
        - condition: state
          entity_id: group.downstairs_windows
          state: "on"
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data_template:
        message:
          Zamknij okna, dziś jest za duży smog ({{ states.sensor.airly_caqi.state
          | int | round }} CAQI).
        language: pl
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data_template:
        title: Alert smogowy
        message:
          W domu okno otwarte, a tu {{ states.sensor.airly_caqi.state | int |
          round }} CAQI!
        data:
          vibrate:
            - 300
            - 100
            - 400
          image: https://cdn.galleries.smcloud.net/t/galleries/gf-iqLN-uVay-HHCu_smog-664x442-nocrop.jpg
    - service: notify.mobile_app_gosia_s_mi_a2_lite
      data_template:
        title: Alert smogowy
        message:
          W domu okno otwarte, a tu {{ states.sensor.airly_caqi.state | int |
          round }} CAQI!
        data:
          vibrate:
            - 300
            - 100
            - 400
          image: https://cdn.galleries.smcloud.net/t/galleries/gf-iqLN-uVay-HHCu_smog-664x442-nocrop.jpg
- id: "1549392798017"
  alias: Others - weekend wake up
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - after: 07:00:00
      before: 09:00:00
      weekday:
        - sat
        - sun
      condition: time
    - entity_id: input_boolean.someone_sleeping_in_the_living_room
      state: "off"
      condition: state
    - condition: template
      value_template:
        "{{ as_timestamp(now()) - as_timestamp(states.automation.others_weekend_wake_up.attributes.last_triggered)
        | int > 43200 }}"
  action:
    - data:
        entity_id: remote.jaskrowo_media
        activity: Listen to music
      service: remote.turn_on
    - service: media_player.volume_set
      data_template:
        entity_id: media_player.lenovosmartdisplay88416
        volume_level: 0.4
    - delay: 00:00:03
    - service: tts.google_translate_say
      entity_id: media_player.lenovosmartdisplay88416
      data:
        message: Dzień dobry Kochanie, specjalnie dla Ciebie piosenka.
        language: pl
    - delay: 00:00:03
    - service: media_player.volume_set
      data_template:
        entity_id: media_player.marantz_sr5008
        volume_level: 0.35
    - service: media_player.select_source
      data_template:
        entity_id: media_player.spotify_wojciech_iskra
        source: Marantz SR5008
    - delay: 00:00:03
    - service: media_player.play_media
      data:
        entity_id: media_player.spotify_wojciech_iskra
        media_content_id: spotify:playlist:37i9dQZF1DWWxPM4nWdhyI
        media_content_type: playlist
    - service: media_player.shuffle_set
      data:
        entity_id: media_player.spotify_wojciech_iskra
        shuffle: true
- id: "1549654128210"
  alias: Living room stairs - motion
  trigger:
    - entity_id: binary_sensor.0x00158d000257a1be_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: switch.shelly1_554b82_relay_0
      state: "off"
    - below: "10"
      condition: numeric_state
      entity_id: sensor.0x00158d000257a1be_illuminance
    - after: 07:30:00
      before: "22:00:00"
      condition: time
  action:
    - data:
        entity_id: switch.shelly1_554b82_relay_0
      service: switch.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d000257a1be_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d000257a1be_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d000257a1be_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: switch.shelly1_554b82_relay_0
      state: "on"
    - data:
        entity_id: switch.shelly1_554b82_relay_0
      service: switch.turn_off
- id: "1549654154926"
  alias: Living room stairs - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d000257a1be_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d000257a1be_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: switch.shelly1_554b82_relay_0
      state: "on"
  action:
    - data:
        entity_id: switch.shelly1_554b82_relay_0
      service: switch.turn_off
- id: "1549810614088"
  alias: Dining area - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        | int >= 900 %}True{% else %}False{% endif %}"
  condition:
    condition: state
    entity_id: group.dining_area
    state: "on"
  action:
    - data:
        entity_id: group.dining_area
      service: homeassistant.turn_off
- id: "1549810691857"
  alias: Kitchen left wall switch - click
  trigger:
    - entity_id: sensor.0x00158d00028f6c2f_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id:
          - switch.shelly1_55df6e_relay_0
      service: switch.toggle
    - data:
        entity_id: light.stove_leds
        transition: 1
      service: light.toggle
- id: "1549810749195"
  alias: Kitchen right wall switch - left button
  trigger:
    - entity_id: sensor.0x00158d0002b48cff_click
      platform: state
      to: left
  condition: []
  action:
    - data:
        entity_id: switch.shelly2_5a4ada_relay_1
      service: switch.toggle
- id: "1549810780701"
  alias: Kitchen right wall switch - right button
  trigger:
    - entity_id: sensor.0x00158d0002b48cff_click
      platform: state
      to: right
  condition: []
  action:
    - data:
        entity_id: switch.shelly2_5a4ada_relay_0
      service: switch.toggle
- id: "1549820992742"
  alias: Kitchen - motion at night
  trigger:
    - entity_id: binary_sensor.0x00158d0002ec7efa_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: switch.0x00158d0003951e91_switch
      state: "off"
    - below: "60"
      condition: numeric_state
      entity_id: sensor.0x00158d0002ec7efa_illuminance
    - condition: or
      conditions:
        - condition: time
          after: "22:00:01"
        - condition: time
          before: 06:29:59
  action:
    - data:
        entity_id: light.stove_leds
        transition: 1
      service: light.turn_on
    - data:
        entity_id: switch.0x00158d0003951e91_switch
      service: switch.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0002ec7efa_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0002ec7efa_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0002ec7efa_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: group.kitchen_lights
      state: "on"
    - data:
        entity_id:
          - group.kitchen_lights
      service: homeassistant.turn_off
- id: "1551162176946"
  alias: Upstairs hall - motion
  trigger:
    - entity_id: binary_sensor.0x00158d000257a1db_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: group.upstairs_hall_lights
      state: "off"
    - below: "30"
      condition: numeric_state
      entity_id: sensor.0x00158d000257a1db_illuminance
    - after: 07:30:00
      before: "20:30:00"
      condition: time
  action:
    - data:
        entity_id: group.upstairs_hall_lights
        transition: 1
      service: homeassistant.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d000257a1db_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d000257a1db_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d000257a1db_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: group.upstairs_hall_lights
      state: "on"
    - data:
        entity_id: group.upstairs_hall_lights
        transition: 1
      service: homeassistant.turn_off
- id: "1551162210734"
  alias: Upstairs hall - empty
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d000257a1db_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d000257a1db_occupancy'].attributes.no_occupancy_since
        | int >= 600 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: group.upstairs_hall_lights
      state: "on"
  action:
    - data:
        entity_id: group.upstairs_hall_lights
        transition: 1
      service: homeassistant.turn_off
- id: "1554142824635"
  alias: Living room stairs - toggle
  trigger:
    - entity_id: sensor.0x00158d00030a302b_click
      platform: state
      to: single
    - entity_id: sensor.0x00158d00030a3104_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: switch.shelly1_554b82_relay_0
      service: switch.toggle
- id: "1554226640385"
  alias: Attic stairs - toggle
  trigger:
    - entity_id: sensor.0x00158d00030ac4de_click
      platform: state
      to: single
    - entity_id: sensor.0x00158d00030a3141_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id:
          - light.0x00158d0003fa55ab_light
          - light.attic_right_lamp_light
        transition: 1
      service: light.toggle
- id: "1554394458437"
  alias: Upstairs hall - toggle
  trigger:
    - entity_id: sensor.0x00158d0003131adb_click
      platform: state
      to: single
    - entity_id: sensor.0x00158d00030ac48b_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id:
          - light.upstairs_hall_left_lamp
          - light.upstairs_hall_right_lamp
        transition: 1
      service: light.toggle
- id: "1554627247755"
  alias: Downstairs bathroom - toggle all
  trigger:
    - entity_id: sensor.0x00158d000123e3fe_click
      platform: state
      to: single
    - entity_id: sensor.0x00158d00030aaa92_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: group.downstairs_bathroom_lights
        transition: 1
      service: homeassistant.toggle
- id: "1554627285943"
  alias: Downstairs bathroom - toggle side
  trigger:
    - entity_id: sensor.0x00158d000123e3fe_click
      platform: state
      to: double
    - entity_id: sensor.0x00158d00030aaa92_click
      platform: state
      to: double
  condition: []
  action:
    - data:
        entity_id: light.downstairs_bathroom_side_lamp
        transition: 1
      service: light.toggle
- id: "1554627478669"
  alias: Downstairs bathroom - toggle ceiling
  trigger:
    - event_data:
        entity_id: binary_sensor.switch_158d000123e3fe
        click_type: long_click_press
      event_type: xiaomi_aqara.click
      platform: event
  condition: []
  action:
    - data:
        entity_id: light.downstairs_bathroom_ceiling_lamp
        transition: 1
      service: light.toggle
- id: "1559483412308"
  alias: Living room - turn on fan daytime
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      platform: state
      to: "on"
  condition:
    - above: "25.0"
      condition: numeric_state
      entity_id: sensor.0x00158d0001b1c3fb_temperature
    - after: 06:30:00
      before: "20:00:00"
      condition: time
  action:
    - data:
        entity_id: fan.xiaomi_smart_fan
      service: fan.turn_on
    - data:
        entity_id: fan.xiaomi_smart_fan
      service: fan.xiaomi_miio_set_natural_mode_off
- id: "1559500105148"
  alias: Living room - turn off fan
  trigger:
    - platform: template
      value_template:
        "{% if states.binary_sensor['0x00158d0001e43ac7_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e43ac7_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e43ac7_occupancy'].attributes.no_occupancy_since
        | int >= 1200 %}True{% else %}False{% endif %}"
  condition:
    - condition: state
      entity_id: fan.xiaomi_smart_fan
      state: "on"
  action:
    - data:
        entity_id: fan.xiaomi_smart_fan
      service: fan.turn_off
- id: "1559584354899"
  alias: Weather - cool the flat down
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      from: "off"
      platform: state
      to: "on"
    - entity_id: binary_sensor.0x00158d0002ec7efa_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - above: 24
      condition: numeric_state
      entity_id: sensor.0x00158d0001b1c3fb_temperature
    - below: "22"
      condition: numeric_state
      entity_id: sensor.0x00158d0001b9208d_temperature
    - condition: state
      entity_id: binary_sensor.0x00158d0001ad5eb6_contact
      for:
        hours: 6
      state: "off"
    - condition: state
      entity_id: binary_sensor.0x00158d00022f148a_contact
      for:
        hours: 6
      state: "off"
    - condition: state
      entity_id: binary_sensor.0x00158d00023709f7_contact
      for:
        hours: 6
      state: "off"
    - after: 08:00:00
      before: "20:00:00"
      condition: time
    - condition: template
      value_template:
        "{{ as_timestamp(now()) - as_timestamp(states.automation.weather_cool_the_flat_down.attributes.last_triggered)
        | int > 600 }}"
  action:
    - data:
        language: pl
        message: Na zewnątrz jest chłodno, otwórz na trochę okna.
      entity_id: media_player.downstairs_speaker
      service: tts.google_translate_say
- id: "1559584380688"
  alias: Weather - too hot outside
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      from: "off"
      platform: state
      to: "on"
    - entity_id: binary_sensor.0x00158d0002ec7efa_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - above: 24
      condition: numeric_state
      entity_id: sensor.0x00158d0001b1c3fb_temperature
    - above: "27"
      condition: numeric_state
      entity_id: sensor.0x00158d0001b9208d_temperature
    - condition: state
      entity_id: binary_sensor.outside_temperature_rising
      state: "on"
    - condition: or
      conditions:
        - condition: state
          entity_id: binary_sensor.0x00158d0001ad5eb6_contact
          state: "on"
        - condition: state
          entity_id: binary_sensor.0x00158d00022f148a_contact
          state: "on"
        - condition: state
          entity_id: binary_sensor.0x00158d00023709f7_contact
          state: "on"
    - after: 08:00:00
      before: "20:00:00"
      condition: time
    - condition: template
      value_template:
        "{{ as_timestamp(now()) - as_timestamp(states.automation.weather_cool_the_flat_down.attributes.last_triggered)
        | int > 600 }}"
  action:
    - data:
        language: pl
        message: Na zewnątrz robi się gorąco, proszę pozamykaj okna.
      entity_id: media_player.downstairs_speaker
      service: tts.google_translate_say
- id: "1559880624653"
  alias: Bathroom - washing machine is done
  trigger:
    - platform: numeric_state
      entity_id: sensor.shelly_plug_s_51d92a_power_0
      below: 5
      for: 00:05:00
  condition:
    - condition: template
      value_template:
        "{{ (state_attr('sensor.washing_machine_power_stats', 'max_value')|int)
        > 10 }}"
    - condition: time
      after: 08:00:00
      before: "22:00:00"
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Pralka skończyła prać. Powieś ubrania.
        language: pl
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data:
        title: Washing machine
        message: "Washing machine seems to be done "
        data:
          android:
            notification:
              image: https://previews.123rf.com/images/memoangeles/memoangeles1606/memoangeles160600003/59790403-cartoon-washing-machine-vector-clip-art-illustration-with-simple-gradients-all-in-a-single-layer-.jpg
    - service: notify.mobile_app_gosia_s_mi_a2_lite
      data:
        title: Pralka
        message: Wygląda, że pralka skończyła prać
        data:
          android:
            notification:
              image: https://previews.123rf.com/images/memoangeles/memoangeles1606/memoangeles160600003/59790403-cartoon-washing-machine-vector-clip-art-illustration-with-simple-gradients-all-in-a-single-layer-.jpg
- id: "1560969416454"
  alias: Living room - turn on fan evening
  trigger:
    - entity_id: binary_sensor.0x00158d0001e43ac7_occupancy
      platform: state
      to: "on"
  condition:
    - above: "25.0"
      condition: numeric_state
      entity_id: sensor.0x00158d0001b1c3fb_temperature
    - after: "20:00:00"
      before: "22:00:00"
      condition: time
  action:
    - data:
        entity_id: fan.xiaomi_smart_fan
      service: fan.turn_on
    - data:
        entity_id: fan.xiaomi_smart_fan
      service: fan.xiaomi_miio_set_natural_mode_on
- id: "1569862674233"
  alias: Kitchen - switch sink light
  trigger:
    - entity_id: sensor.0x00158d0001b1286b_click
      platform: state
      to: single
  condition: []
  action:
    - data:
        entity_id: switch.0x00158d0003951e91_switch
      service: switch.toggle
- id: "1569862819815"
  alias: Kitchen switch ceiling light
  trigger:
    - entity_id: sensor.0x00158d0001b1286b_click
      platform: state
      to: double
  condition: []
  action:
    - data:
        entity_id: switch.shelly1_55df6e_relay_0
      service: switch.toggle
- id: "1575388333096"
  alias: Dining area - motion
  trigger:
    - entity_id: binary_sensor.0x00158d0001655da1_occupancy
      from: "off"
      platform: state
      to: "on"
  condition:
    - condition: state
      entity_id: group.dining_area
      state: "off"
    - after: 07:30:00
      before: "22:00:00"
      condition: time
    - below: "60"
      condition: numeric_state
      entity_id: sensor.0x00158d0002ec7efa_illuminance
  action:
    - data:
        entity_id:
          - switch.shelly2_5a4ada_relay_1
      service: switch.turn_on
    - wait_template:
        "{% if states.binary_sensor['0x00158d0001e531e0_occupancy'].state
        == 'off' and states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        and states.binary_sensor['0x00158d0001e531e0_occupancy'].attributes.no_occupancy_since
        | int >= 300 %}True{% else %}False{% endif %}"
    - condition: state
      entity_id: group.dining_area
      state: "on"
    - data:
        entity_id:
          - group.dining_area
      service: homeassistant.turn_off
- id: "1577216646456"
  alias: Vacuum - scheduled cleanup
  description: Clean up apartment on weekdays @ 11:30
  trigger:
    - at: "11:30"
      platform: time
  condition:
    - condition: time
      weekday:
        - mon
        - tue
        - wed
        - thu
        - fri
  action:
    - entity_id: script.vacuum_start_cleaning
      service: script.turn_on
- alias: Trigger alarm while armed away
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.0x00158d0001e43ac7_occupancy
        - binary_sensor.0x00158d000257a1be_occupancy
        - binary_sensor.0x00158d0001e43bc7_occupancy
        - binary_sensor.0x00158d0001e4707c_occupancy
        - binary_sensor.0x00158d0001e531e0_occupancy
        - binary_sensor.0x00158d0001e532dc_occupancy
        - binary_sensor.0x00158d0001e547ae_occupancy
        - binary_sensor.0x00158d0001e55ff7_occupancy
        - binary_sensor.0x00158d0002b70d79_occupancy
        - binary_sensor.0x00158d0002b85113_occupancy
        - binary_sensor.0x00158d000257a1db_occupancy
        - binary_sensor.0x00158d0002ec7efa_occupancy
        - binary_sensor.0x00158d0001655da1_occupancy
        - binary_sensor.0x00158d0002b72030_occupancy
        - binary_sensor.0x00158d0002b422b4_occupancy
        - binary_sensor.0x00158d0002ebdbdf_occupancy
      to: "on"
  condition:
    - condition: state
      entity_id: alarm_control_panel.ha_alarm
      state: armed_away
  action:
    - service: alarm_control_panel.alarm_trigger
      entity_id: alarm_control_panel.ha_alarm
  id: 519875f86a2f4ae88941f6a1f9a97d01
- alias: Send notification when alarm triggered
  trigger:
    - platform: state
      entity_id: alarm_control_panel.ha_alarm
      to: triggered
  action:
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data_template:
        message: ALARM! The alarm has been triggered
        data:
          android:
            notification:
              image:
                "https://t8rvacetnpv7de2kvwrbusxxhurmyci8.ui.nabu.casa{{ states.camera.yi_hack_01.attributes.entity_picture
                }}

                "
    - service: notify.mobile_app_gosia_s_mi_a2_lite
      data_template:
        message: ALARM! The alarm has been triggered
        data:
          android:
            notification:
              image:
                "https://t8rvacetnpv7de2kvwrbusxxhurmyci8.ui.nabu.casa{{ states.camera.yi_hack_01.attributes.entity_picture
                }}

                "
    - service: media_player.volume_set
      data_template:
        entity_id: media_player.downstairs_speaker
        volume_level: 0.8
    - delay: 00:00:01
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data_template:
        message: Powiadomiłem właścicieli i policję - bagiety już jadą
        language: pl
    - service: xiaomi_aqara.play_ringtone
      data:
        gw_mac: 34:CE:00:88:A5:79
        ringtone_id: 8
        ringtone_vol: 30
    - service: xiaomi_aqara.play_ringtone
      data:
        gw_mac: 34:CE:00:FB:56:E8
        ringtone_id: 8
        ringtone_vol: 30
    - service: xiaomi_aqara.play_ringtone
      data:
        gw_mac: 04:CF:8C:B8:7B:D4
        ringtone_id: 8
        ringtone_vol: 30
    - data:
        entity_id:
          - switch.circadian_lighting_hall_lights_auto
          - switch.circadian_lighting_living_room_auto_ceiling
          - switch.circadian_lighting_living_room_auto_leds
          - switch.circadian_lighting_guest_room_lights_auto
          - switch.circadian_lighting_attic_lights_auto
          - switch.circadian_lighting_master_bedroom_lights_auto
          - switch.circadian_lighting_kitchen_lights_auto
          - switch.circadian_lighting_tosia_room_lights_auto
          - switch.circadian_lighting_wardrobe_lights_auto
          - switch.circadian_lighting_downstairs_bathroom_lights_auto
      service: switch.turn_off
    - data:
        entity_id:
          - light.downstairs_hall_lamp
          - light.downstairs_bathroom_ceiling_lamp
          - light.wall_leds
          - light.stairs_leds
          - light.stove_leds
        effect: Police
      service: light.turn_on
    - delay: 00:00:05
    - service: media_player.volume_set
      data_template:
        entity_id: media_player.lenovosmartdisplay88416
        volume_level: 0.4
  id: 1816d6e6ece24085bded2a74127d6513
- alias: Send notification when alarm is Armed in Away mode
  trigger:
    - platform: state
      entity_id: alarm_control_panel.ha_alarm
      to: pending
  condition:
    - condition: template
      value_template:
        '{{ state_attr("alarm_control_panel.ha_alarm", "post_pending_state")
        == "armed_away" }}'
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Alarm uzbrojony, masz 10 sekund na wyjście.
        language: pl
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data_template:
        message: ALARM! The alarm is armed
  id: 12c8cc91e5e14d18aa3d0d72715645f0
- alias: Disarm alarm when we're getting home
  trigger:
    - platform: state
      entity_id:
        - person.wojciech_iskra
        - person.malgorzata_iskra
      from: not_home
      to: home
  condition:
    - condition: state
      entity_id: alarm_control_panel.ha_alarm
      state: armed_away
  action:
    - service: alarm_control_panel.alarm_disarm
      data:
        entity_id: alarm_control_panel.ha_alarm
        code: 2310
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data_template:
        message: Welcome home! The alarm disarmed successfully
  id: 2404b66ad6674a8c985dec79d2d04ef3
- alias: Send notification when alarm is disarmed
  trigger:
    - platform: state
      entity_id: alarm_control_panel.ha_alarm
      to: disarmed
  action:
    - service: tts.google_translate_say
      entity_id: media_player.downstairs_speaker
      data:
        message: Alarm wyłączony
        language: pl
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data_template:
        message: The alarm disarmed successfully
    - data:
        entity_id:
          - switch.circadian_lighting_hall_lights_auto
          - switch.circadian_lighting_living_room_auto_ceiling
          - switch.circadian_lighting_living_room_auto_leds
          - switch.circadian_lighting_guest_room_lights_auto
          - switch.circadian_lighting_attic_lights_auto
          - switch.circadian_lighting_master_bedroom_lights_auto
          - switch.circadian_lighting_kitchen_lights_auto
          - switch.circadian_lighting_tosia_room_lights_auto
          - switch.circadian_lighting_wardrobe_lights_auto
          - switch.circadian_lighting_downstairs_bathroom_lights_auto
      service: switch.turn_on
    - data:
        entity_id:
          - light.downstairs_hall_lamp
          - light.downstairs_bathroom_ceiling_lamp
          - light.wall_leds
          - light.stairs_leds
          - light.stove_leds
        transition: 1
      service: light.turn_off
  id: 184debd9df574d06aad9e8c467155a62
- alias: "TESTING: Wojtek left home"
  trigger:
    - platform: state
      entity_id: person.wojciech_iskra
      from: home
      to: not_home
  action:
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data_template:
        message: Home assistant detected you left home
  id: d27b90ac7e2746d4a2dabeffe17d3fa0
- alias: "TESTING: Wojtek is back home"
  trigger:
    - platform: state
      entity_id: person.wojciech_iskra
      from: not_home
      to: home
  action:
    - service: notify.mobile_app_wojtek_s_mi_mix_2
      data:
        message: Home assistant detected you're back home
  id: 0fc5e331592f4ec69307f2318dac3dc7
- id: enable_zigbee_join
  alias: Enable Zigbee joining
  trigger:
    platform: state
    entity_id: input_boolean.zigbee_permit_join
    to: "on"
  action:
    - service: mqtt.publish
      data:
        topic: zigbee2mqtt/bridge/config/permit_join
        payload: "true"
    - service: timer.start
      data:
        entity_id: timer.zigbee_permit_join
- id: disable_zigbee_join
  alias: Disable Zigbee joining
  trigger:
    - entity_id: input_boolean.zigbee_permit_join
      platform: state
      to: "off"
  action:
    - data:
        payload: "false"
        topic: zigbee2mqtt/bridge/config/permit_join
      service: mqtt.publish
    - data:
        entity_id: timer.zigbee_permit_join
      service: timer.cancel
- id: disable_zigbee_join_timer
  alias: Disable Zigbee joining by timer
  trigger:
    - platform: event
      event_type: timer.finished
      event_data:
        entity_id: timer.zigbee_permit_join
  action:
    - service: mqtt.publish
      data:
        topic: zigbee2mqtt/bridge/config/permit_join
        payload: "false"
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.zigbee_permit_join
- id: shellies_announce
  alias: Shellies Announce
  trigger:
    - platform: homeassistant
      event: start
  action:
    service: mqtt.publish
    data:
      topic: shellies/command
      payload: announce
- id: shellies_discovery
  alias: Shellies Discovery
  trigger:
    - platform: mqtt
      topic: shellies/announce
  action:
    service: python_script.shellies_discovery
    data_template:
      id: "{{ trigger.payload_json.id }}"
      mac: "{{ trigger.payload_json.mac }}"
      fw_ver: "{{ trigger.payload_json.fw_ver }}"
- id: "1579586601273"
  alias: Wojtek is cycling
  description: ""
  trigger:
    - entity_id: sensor.zwift_online_1380479
      from: "False"
      platform: state
      to: "True"
  condition: []
  action:
    - entity_id: scene.wojtek_is_cycling
      service: scene.turn_on
- id: "1579586727557"
  alias: Wojtek finished cycling
  description: ""
  trigger:
    - entity_id: sensor.zwift_online_1380479
      from: "True"
      platform: state
      to: "False"
  condition: []
  action:
    - scene: scene.wojtek_finished_cycling
- id: update_networkmap
  alias: Update Zigbee Map
  trigger:
    platform: time_pattern
    minutes: /15
    seconds: 0
  action:
    service: zigbee2mqtt_networkmap.update
- id: "1584882369650"
  alias: Living room - sleeping mode on
  description: ""
  trigger:
    - entity_id: input_boolean.someone_sleeping_in_the_living_room
      from: "off"
      platform: state
      to: "on"
  condition: []
  action:
    - data:
        entity_id:
          - automation.living_room_motion_01_normal
          - automation.living_room_motion_02_evening
          - automation.living_room_motion_03_tv_mode
      service: automation.turn_off
    - data:
        entity_id:
          - group.living_room_lights
          - group.kitchen_lights
          - group.dining_area
      service: homeassistant.turn_off
- id: "1584882369651"
  alias: Living room - sleeping mode off
  description: ""
  trigger:
    - entity_id: input_boolean.someone_sleeping_in_the_living_room
      from: "on"
      platform: state
      to: "off"
    - platform: state
      entity_id: input_boolean.someone_sleeping_in_the_living_room
      to: "on"
      for: "12:00:00"
  condition: []
  action:
    - data:
        entity_id:
          - automation.living_room_motion_01_normal
          - automation.living_room_motion_02_evening
          - automation.living_room_motion_03_tv_mode
      service: automation.turn_on
    - data:
        entity_id:
          - switch.circadian_lighting_living_room_auto_ceiling
      service: switch.turn_on
    - data:
        entity_id:
          - input_boolean.someone_sleeping_in_the_living_room
      service: input_boolean.turn_off
